define(['jquery'], function($) {

    return {
        avaliar_curso_verif: function($porcentagem, $pagina_para_avaliar, $avaliado, $url, $curso) {
            $(function() {
                if ($porcentagem == 100 && $avaliado == false && $pagina_para_avaliar == true) {
                    $(document).ready(function() {
                        $('#modal_avaliar_curso').modal('show');
                        $('#form-rate').submit(function(event) {
                            $.ajax({
                                type: "POST",
                                url: $url + '/theme/avasus3/cursos/alterarate.php',
                                data: $('#form-rate').serialize(),
                                dataType: 'json'
                            }).fail(function() {
                                var erro_alert = '<div class="alert alert-danger" role="alert">Erro ao enviar avaliação!</div>'
                                var erro_icon = '<h1 style="text-align: center;color: red;font-size: 100px;"><i class="fa fa-times" style="text-alight"></i></h1';
                                var botao = '<button type="button" class="btn btn-cancel" onclick=" window.location.href =' + "'" + $url + "/course/view.php?id=" + $curso + "'" + ';">Tentar Novamente</button>';
                                $('#form-rate').children('.modal-body').html(erro_alert + erro_icon);
                                $('#form-rate').children('.modal-footer').html(botao)
                            }).done(function() {
                                var sucesso_alert = '<div class="alert alert-success" role="alert">Avaliação enviada com sucesso! OBRIGADO pelo seu comentário.</div>'
                                var sucesso_icon = '<h1 style="text-align: center;color: green;font-size: 100px;"><i class="fa fa-check" style="text-alight"></i></h1';
                                var botao = '<button type="button" class="btn btn-danger" onclick=" window.location.href =' + "'" + $url + "/course/view.php?id=" + $curso + "'" + ';">Concluir</button>';
                                $('#form-rate').children('.modal-body').html(sucesso_alert + sucesso_icon);
                                $('#form-rate').children('.modal-footer').html(botao)
                            })
                            event.preventDefault();
                        });
                    });
                } else if ($porcentagem == 100 && $avaliado == true && $pagina_para_avaliar == true) {
                    $('#reclassificar_curso').click(function() {
                        $('#modal_avaliar_curso').modal('show');
                        $('#form-rate').submit(function(event) {
                            $.ajax({
                                type: "POST",
                                url: $url + '/theme/avasus3/cursos/alterarate.php',
                                data: $('#form-rate').serialize(),
                                dataType: 'json'
                            }).fail(function() {
                                var erro_alert = '<div class="alert alert-danger" role="alert">Erro ao enviar avaliação!</div>'
                                var erro_icon = '<h1 style="text-align: center;color: red;font-size: 100px;"><i class="fa fa-times" style="text-alight"></i></h1';
                                var botao = '<button type="button" class="btn btn-cancel" onclick=" window.location.href =' + "'" + $url + "/course/view.php?id=" + $curso + "'" + ';">Tentar Novamente</button>';
                                $('#form-rate').children('.modal-body').html(erro_alert + erro_icon);
                                $('#form-rate').children('.modal-footer').html(botao)
                            }).done(function() {
                                var sucesso_alert = '<div class="alert alert-success" role="alert">Avaliação enviada com sucesso! OBRIGADO pelo seu comentário.</div>'
                                var sucesso_icon = '<h1 style="text-align: center;color: green;font-size: 100px;"><i class="fa fa-check" style="text-alight"></i></h1';
                                var botao = '<button type="button" class="btn btn-danger" onclick=" window.location.href =' + "'" + $url + "/course/view.php?id=" + $curso + "'" + ';">Concluir</button>';
                                $('#form-rate').children('.modal-body').html(sucesso_alert + sucesso_icon);
                                $('#form-rate').children('.modal-footer').html(botao)
                            })
                            event.preventDefault();
                        });
                    });
                }
            });
        }
    };
});